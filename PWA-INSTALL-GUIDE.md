# 📱 油爐管理系統 PWA APP 安裝指南

## ✨ 什麼是 PWA？

PWA (Progressive Web App) 是一種可以像原生 APP 一樣使用的網頁應用程式。

### 優點：
✅ 無需上架 App Store 或 Google Play
✅ 可安裝到手機桌面，像 APP 一樣開啟
✅ 支援離線使用（查看已快取的資料）
✅ 更快的載入速度
✅ 自動更新（不需手動更新）
✅ 跨平台：iOS、Android、電腦都可用

---

## 📦 部署步驟

### 1️⃣ 上傳檔案到伺服器

將以下檔案上傳到你的網站伺服器：

```
📁 你的網站目錄/
├── boiler-dashboard-simple.html    (主儀表板)
├── qr-mobile-multilang.html        (手機輸入頁面)
├── manifest.json                   (PWA 設定檔)
├── service-worker.js               (離線功能)
├── icon-192.png                    (APP 小圖示)
└── icon-512.png                    (APP 大圖示)
```

### 2️⃣ 確保 HTTPS

⚠️ **重要**: PWA 必須使用 HTTPS（安全連線）才能運作

- 如果你的網站還沒有 SSL 憑證，請向主機商申請
- 測試時可以使用 localhost（本機測試）

### 3️⃣ 測試 PWA 功能

開啟 Chrome 瀏覽器的開發者工具：
1. 按 F12 開啟開發者工具
2. 切換到 "Application" 標籤
3. 左側選單點選 "Service Workers"
4. 應該會看到你的 Service Worker 已註冊

---

## 📱 如何安裝到手機

### **Android 手機** (Chrome 瀏覽器)

1. 用 Chrome 開啟網址：`https://你的網址/boiler-dashboard-simple.html`
2. 會自動出現「安裝 APP」的提示框
   - 或點擊右下角浮動的 **"📱 安裝 APP"** 按鈕
3. 點選「安裝」或「新增至主畫面」
4. APP 圖示會出現在手機桌面
5. 完成！像普通 APP 一樣點開使用

### **iPhone (iOS)** (Safari 瀏覽器)

1. 用 Safari 開啟網址：`https://你的網址/boiler-dashboard-simple.html`
2. 點擊底部的「分享」按鈕 📤
3. 向下滑動，找到「加入主畫面」
4. 可以自訂 APP 名稱（預設：油爐管理）
5. 點選「新增」
6. APP 圖示會出現在 iPhone 桌面
7. 完成！

### **電腦瀏覽器** (Chrome/Edge)

1. 用 Chrome 或 Edge 開啟網址
2. 網址列右側會出現「安裝」圖示 ⊕
3. 點擊「安裝」
4. APP 會像桌面程式一樣開啟
5. 可以固定到工作列

---

## 🔧 PWA 功能說明

### ✅ 已實現功能：

1. **離線快取**
   - Service Worker 會自動快取網頁和資源
   - 沒有網路時仍可開啟 APP（但無法提交新資料）

2. **自動安裝提示**
   - 第一次訪問時，會在右下角顯示「📱 安裝 APP」按鈕
   - 點擊即可安裝

3. **APP 圖示**
   - 192x192 和 512x512 兩種尺寸
   - 火焰🔥圖案 + 漸層藍色背景

4. **多語言支援**
   - PWA 完整保留原有的中/越/泰三語功能

5. **獨立視窗**
   - 安裝後像原生 APP 一樣全螢幕顯示
   - 沒有瀏覽器的網址列

### 📊 離線功能限制：

✅ **離線可用**：
- 查看儀表板
- 查看已快取的運行記錄
- 切換語言
- 瀏覽統計圖表

❌ **離線不可用**（需要網路）：
- 提交新的運行記錄
- 從 Google Sheets 載入最新資料
- 水質檢查、加藥記錄等提交功能

---

## 🧪 測試檢查清單

安裝完成後，請測試以下項目：

- [ ] APP 圖示正常顯示
- [ ] 點擊圖示可開啟 APP
- [ ] 登入功能正常（輸入工號）
- [ ] 語言切換正常
- [ ] 儀表板數據顯示正常
- [ ] 圖表可以正常渲染
- [ ] 嘗試關閉網路，APP 仍可開啟（但無法提交資料）
- [ ] QR Code 掃描頁面也能正常使用

---

## 🔄 更新 APP

當你修改程式碼後，員工不需要重新安裝：

1. 更新 `service-worker.js` 中的版本號：
   ```javascript
   const CACHE_NAME = 'boiler-management-v1.0.1';  // 改變版本號
   ```

2. 員工下次開啟 APP 時，會自動下載更新

3. 可能需要關閉 APP 重開一次才會套用更新

---

## ⚙️ 自訂設定

### 修改 APP 名稱

編輯 `manifest.json`：
```json
{
  "name": "你的公司名稱 - 油爐管理系統",
  "short_name": "油爐管理"
}
```

### 修改 APP 顏色

編輯 `manifest.json`：
```json
{
  "background_color": "#0c1821",  // 背景色
  "theme_color": "#0a4d68"         // 主題色（影響狀態列）
}
```

### 更換 APP 圖示

替換 `icon-192.png` 和 `icon-512.png` 兩個檔案即可

---

## 🐛 疑難排解

### 問題 1: 沒有出現「安裝 APP」按鈕

**原因**: 
- 網站沒有使用 HTTPS
- Service Worker 註冊失敗
- 瀏覽器不支援 PWA

**解決方法**:
1. 確認網址是 `https://` 開頭
2. 開啟 Console 查看錯誤訊息
3. 確認檔案路徑正確

### 問題 2: 安裝後圖示是空白的

**原因**: 圖示檔案路徑錯誤

**解決方法**:
1. 確認 `icon-192.png` 和 `icon-512.png` 在正確位置
2. 檢查 `manifest.json` 中的路徑設定

### 問題 3: Service Worker 註冊失敗

**解決方法**:
1. 開啟 Chrome DevTools (F12)
2. 切到 "Application" → "Service Workers"
3. 點選 "Unregister" 解除註冊
4. 重新整理頁面，重新註冊

### 問題 4: iOS 安裝後無法開啟

**原因**: iOS 的 PWA 限制較多

**解決方法**:
1. 確認 `manifest.json` 中有設定 `start_url`
2. 確認所有資源都是 HTTPS
3. 嘗試清除 Safari 快取後重新安裝

---

## 📞 技術支援

如果遇到問題，請檢查：

1. **瀏覽器 Console** (F12 → Console)
   - 查看錯誤訊息
   - 確認 Service Worker 是否註冊成功

2. **網路請求** (F12 → Network)
   - 確認檔案都能正常載入
   - 檢查 Google Apps Script 連線狀態

3. **Application 標籤** (F12 → Application)
   - 查看 Manifest 是否正確
   - 查看 Service Worker 狀態
   - 查看 Cache Storage（快取內容）

---

## 🎯 與原生 APP 的比較

| 功能 | PWA | 原生 APP |
|------|-----|----------|
| 開發成本 | ⭐⭐⭐⭐⭐ 低 | ⭐⭐ 高 |
| 上架流程 | ✅ 無需上架 | ❌ 需要審核 |
| 安裝大小 | ⭐⭐⭐⭐⭐ 幾 KB | ⭐⭐ 幾十 MB |
| 更新速度 | ✅ 即時更新 | ❌ 需手動更新 |
| 離線功能 | ⭐⭐⭐⭐ 有限支援 | ⭐⭐⭐⭐⭐ 完整 |
| 推送通知 | ⭐⭐⭐ Android 支援 | ⭐⭐⭐⭐⭐ 完整 |
| 硬體存取 | ⭐⭐⭐ 部分支援 | ⭐⭐⭐⭐⭐ 完整 |

---

## 📚 延伸功能（可選）

如果未來需要更進階的功能，可以考慮：

1. **推送通知** - 提醒員工檢查油爐
2. **背景同步** - 離線時儲存資料，有網路時自動上傳
3. **相機整合** - 拍照記錄維修情況
4. **位置定位** - 記錄操作地點

這些功能都可以基於目前的 PWA 架構擴充。

---

**🎉 恭喜！你的油爐管理系統現在是一個可安裝的 PWA APP 了！**

員工可以像使用普通 APP 一樣使用它，而你不需要上架到任何應用商店。
