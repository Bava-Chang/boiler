<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- PWA Support -->
    <meta name="theme-color" content="#0a4d68">
    <link rel="manifest" href="./manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    
    <title>Ê≤πÁàêÊï∏ÊìöÈåÑÂÖ• | Nh·∫≠p li·ªáu l√≤ d·∫ßu | ‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ï‡∏≤</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Noto+Sans+Thai:wght@400;500;700&family=Noto+Sans:wght@400;500;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #0a4d68;
            --primary-light: #088395;
            --accent: #05bfdb;
            --success: #10b981;
            --danger: #ef4444;
            --bg-primary: #f8f9fa;
            --bg-secondary: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border: #e5e7eb;
        }

        body {
            font-family: 'Noto Sans TC', 'Noto Sans Thai', 'Noto Sans', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            padding-bottom: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Login Screen */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #0a4d68 0%, #088395 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }

        .login-card {
            background: white;
            padding: 40px 30px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 360px;
            text-align: center;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent), var(--primary-light));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 40px;
        }

        .login-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
        }

        .login-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 30px;
        }

        .login-input {
            width: 100%;
            padding: 16px;
            background: var(--bg-primary);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 18px;
            text-align: center;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 2px;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .login-input:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent), var(--primary-light));
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 16px rgba(5, 191, 219, 0.4);
        }

        .login-btn:active {
            transform: scale(0.98);
        }

        .login-error {
            color: var(--danger);
            font-size: 14px;
            margin-top: 10px;
            display: none;
        }

        .login-error.show {
            display: block;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(10, 77, 104, 0.3);
        }

        .header-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .header-user {
            font-size: 14px;
            opacity: 0.9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logout-btn-mobile {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 6px 14px;
            border-radius: 8px;
            color: white;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
        }

        /* Status */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Type Selector */
        .type-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .type-btn {
            padding: 16px;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .type-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(10, 77, 104, 0.3);
        }

        .type-btn:active {
            transform: scale(0.98);
        }

        /* Form Card */
        .form-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
        }

        .form-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .required {
            color: var(--danger);
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            color: var(--text-primary);
            background: var(--bg-primary);
            transition: all 0.3s;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .input-unit {
            position: relative;
        }

        .input-unit .unit {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 14px;
            pointer-events: none;
        }

        .input-unit input {
            padding-right: 45px;
        }

        /* Water-Fuel Ratio Display */
        .calculation-display {
            background: linear-gradient(135deg, rgba(5, 191, 219, 0.1), rgba(8, 131, 149, 0.1));
            border: 2px solid var(--accent);
            border-radius: 12px;
            padding: 16px;
            margin-top: 20px;
            text-align: center;
        }

        .calc-label {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .calc-value {
            font-size: 32px;
            font-weight: 900;
            font-family: 'Orbitron', sans-serif;
            color: var(--accent);
            text-shadow: 0 2px 8px rgba(5, 191, 219, 0.3);
        }

        .calc-unit {
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .calc-status {
            margin-top: 8px;
            font-size: 13px;
            font-weight: 600;
        }

        .calc-status.optimal {
            color: var(--success);
        }

        .calc-status.warning {
            color: var(--danger);
        }

        /* Submit Button */
        .submit-section {
            position: sticky;
            bottom: 20px;
            margin-top: 30px;
        }

        .submit-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent), var(--primary-light));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 16px rgba(5, 191, 219, 0.4);
        }

        .submit-btn:active {
            transform: scale(0.98);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: var(--success);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            min-width: 280px;
            text-align: center;
            font-weight: 600;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast.error {
            background: var(--danger);
        }

        /* Loading */
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .submit-btn.loading .btn-text {
            display: none;
        }

        .submit-btn.loading .loading-spinner {
            display: block;
        }

        /* Helper Text */
        .helper-text {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 6px;
        }

        @media (max-width: 480px) {
            .container {
                padding: 12px;
            }
            
            .header {
                padding: 16px;
            }
            
            .form-card {
                padding: 20px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div id="toast" class="toast"></div>

    <script>
        // ÈÖçÁΩÆ
        const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL';

        // Âì°Â∑•Ë≥áÊñôÂ∫´
        const EMPLOYEE_DATABASE = {
            'A001': { name: 'Nguy·ªÖn VƒÉn A', nationality: 'vi', language: 'vi' },
            'A002': { name: 'Tr·∫ßn Th·ªã B', nationality: 'vi', language: 'vi' },
            'A003': { name: 'L√™ VƒÉn C', nationality: 'vi', language: 'vi' },
            'B001': { name: '‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡∏°‡∏≤‡∏•‡∏±‡∏¢', nationality: 'th', language: 'th' },
            'B002': { name: '‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏ß‡∏á‡∏®‡πå‡πÉ‡∏´‡∏ç‡πà', nationality: 'th', language: 'th' },
            'B003': { name: '‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò ‡∏™‡∏∏‡∏Ç‡∏™‡∏±‡∏ô‡∏ï‡πå', nationality: 'th', language: 'th' },
            'C001': { name: 'Âºµ‰∏â', nationality: 'tw', language: 'zh' },
            'C002': { name: 'ÊùéÂõõ', nationality: 'tw', language: 'zh' },
            'C003': { name: 'Áéã‰∫î', nationality: 'tw', language: 'zh' },
            'TEST': { name: 'Test User', nationality: 'tw', language: 'zh' }
        };

        // Â§öË™ûË®ÄÁøªË≠Ø
        const TRANSLATIONS = {
            zh: {
                loginTitle: 'Ê≤πÁàêÊï∏ÊìöÈåÑÂÖ•',
                loginSubtitle: 'Ë´ãËº∏ÂÖ•Â∑•ËôüÁôªÂÖ•',
                loginPlaceholder: 'Ëº∏ÂÖ•Â∑•Ëôü',
                loginButton: 'ÁôªÂÖ•',
                loginError: 'Â∑•Ëôü‰∏çÂ≠òÂú®',
                welcome: 'Ê≠°Ëøé',
                logout: 'ÁôªÂá∫',
                statusOnline: 'Á≥ªÁµ±ÈÄ£Á∑öÊ≠£Â∏∏',
                operationRecord: 'üìä ÈÅãË°åË®òÈåÑ',
                waterQuality: 'üíß Ê∞¥Ë≥™Ê™¢Êü•',
                chemicalRecord: 'üíä Âä†Ëó•Ë®òÈåÑ',
                maintenance: 'üîß Á∂≠‰øÆ‰øùÈ§ä',
                oilStart: 'Ê≤πÈáèËµ∑',
                oilEnd: 'Ê≤πÈáèË®ñ',
                water: 'Áî®Ê∞¥Èáè',
                runtime: 'ÈÅãË°åÊôÇÈñì',
                waterFuelRatio: 'Ê∞¥ÁÖ§ÊØî',
                optimal: 'ÊúÄ‰Ω≥ÁØÑÂúç',
                warning: 'Ë∂ÖÂá∫ÁØÑÂúç',
                liter: 'L',
                hour: 'hr',
                literPerLiter: 'LÊ∞¥/LÊ≤π',
                phValue: 'pHÂÄº',
                hardness: 'Á°¨Â∫¶',
                chloride: 'Ê∞ØÈõ¢Â≠ê',
                conductivity: 'ÈõªÂ∞éÁéá',
                standard: 'Ê®ôÊ∫ñ',
                chemicalType: 'Ëó•ÂäëÈ°ûÂûã',
                amount: 'Âä†Ëó•Èáè',
                note: 'ÂÇôË®ª',
                optional: 'ÈÅ∏Â°´',
                maintenanceType: 'È°ûÂûã',
                items: 'Á∂≠‰øÆÈ†ÖÁõÆ',
                nextDate: '‰∏ãÊ¨°‰øùÈ§äÊó•Êúü',
                selectType: 'Ë´ãÈÅ∏Êìá',
                dailyCheck: 'Êó•Ê™¢',
                weeklyCheck: 'ÈÄ±Ê™¢',
                monthlyCheck: 'ÊúàÊ™¢',
                repair: 'ÊïÖÈöúÁ∂≠‰øÆ',
                emergencyRepair: 'Á∑äÊÄ•Á∂≠‰øÆ',
                submit: 'üì§ Êèê‰∫§Ë®òÈåÑ',
                submitting: 'Êèê‰∫§‰∏≠...',
                submitSuccess: '‚úÖ Ë®òÈåÑÂ∑≤ÊàêÂäüÊèê‰∫§!',
                submitError: '‚ùå Êèê‰∫§Â§±Êïó,Ë´ãÁ®çÂæåÂÜçË©¶',
                cancel: 'ÂèñÊ∂à',
                required: 'ÂøÖÂ°´'
            },
            vi: {
                loginTitle: 'Nh·∫≠p li·ªáu l√≤ d·∫ßu',
                loginSubtitle: 'Vui l√≤ng nh·∫≠p m√£ nh√¢n vi√™n',
                loginPlaceholder: 'Nh·∫≠p m√£',
                loginButton: 'ƒêƒÉng nh·∫≠p',
                loginError: 'M√£ kh√¥ng t·ªìn t·∫°i',
                welcome: 'Ch√†o',
                logout: 'ƒêƒÉng xu·∫•t',
                statusOnline: 'H·ªá th·ªëng k·∫øt n·ªëi b√¨nh th∆∞·ªùng',
                operationRecord: 'üìä H·ªì s∆° v·∫≠n h√†nh',
                waterQuality: 'üíß Ki·ªÉm tra n∆∞·ªõc',
                chemicalRecord: 'üíä H·ªì s∆° h√≥a ch·∫•t',
                maintenance: 'üîß B·∫£o tr√¨',
                oilStart: 'D·∫ßu ƒë·∫ßu',
                oilEnd: 'D·∫ßu cu·ªëi',
                water: 'L∆∞·ª£ng n∆∞·ªõc',
                runtime: 'Th·ªùi gian ho·∫°t ƒë·ªông',
                waterFuelRatio: 'T·ª∑ l·ªá n∆∞·ªõc/d·∫ßu',
                optimal: 'Ph·∫°m vi t·ªëi ∆∞u',
                warning: 'V∆∞·ª£t ph·∫°m vi',
                liter: 'L',
                hour: 'gi·ªù',
                literPerLiter: 'L n∆∞·ªõc/L d·∫ßu',
                phValue: 'Gi√° tr·ªã pH',
                hardness: 'ƒê·ªô c·ª©ng',
                chloride: 'Clo',
                conductivity: 'ƒê·ªô d·∫´n',
                standard: 'Ti√™u chu·∫©n',
                chemicalType: 'Lo·∫°i h√≥a ch·∫•t',
                amount: 'S·ªë l∆∞·ª£ng',
                note: 'Ghi ch√∫',
                optional: 'T√πy ch·ªçn',
                maintenanceType: 'Lo·∫°i',
                items: 'H·∫°ng m·ª•c',
                nextDate: 'L·∫ßn b·∫£o tr√¨ ti·∫øp theo',
                selectType: 'Ch·ªçn lo·∫°i',
                dailyCheck: 'Ki·ªÉm tra h√†ng ng√†y',
                weeklyCheck: 'Ki·ªÉm tra h√†ng tu·∫ßn',
                monthlyCheck: 'Ki·ªÉm tra h√†ng th√°ng',
                repair: 'S·ª≠a ch·ªØa h·ªèng h√≥c',
                emergencyRepair: 'S·ª≠a ch·ªØa kh·∫©n c·∫•p',
                submit: 'üì§ G·ª≠i h·ªì s∆°',
                submitting: 'ƒêang g·ª≠i...',
                submitSuccess: '‚úÖ ƒê√£ g·ª≠i th√†nh c√¥ng!',
                submitError: '‚ùå G·ª≠i th·∫•t b·∫°i, vui l√≤ng th·ª≠ l·∫°i',
                cancel: 'H·ªßy',
                required: 'B·∫Øt bu·ªôc'
            },
            th: {
                loginTitle: '‡∏õ‡πâ‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ï‡∏≤‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô',
                loginSubtitle: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
                loginPlaceholder: '‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™',
                loginButton: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö',
                loginError: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ',
                welcome: '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ',
                logout: '‡∏≠‡∏≠‡∏Å',
                statusOnline: '‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥',
                operationRecord: 'üìä ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏á‡∏≤‡∏ô',
                waterQuality: 'üíß ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ô‡πâ‡∏≥',
                chemicalRecord: 'üíä ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ',
                maintenance: 'üîß ‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤',
                oilStart: '‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô',
                oilEnd: '‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î',
                water: '‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥',
                runtime: '‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',
                waterFuelRatio: '‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ô‡πâ‡∏≥/‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô',
                optimal: '‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°',
                warning: '‡πÄ‡∏Å‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏á',
                liter: 'L',
                hour: '‡∏ä‡∏°.',
                literPerLiter: 'L ‡∏ô‡πâ‡∏≥/L ‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô',
                phValue: '‡∏Ñ‡πà‡∏≤ pH',
                hardness: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏∞‡∏î‡πâ‡∏≤‡∏á',
                chloride: '‡∏Ñ‡∏•‡∏≠‡πÑ‡∏£‡∏î‡πå',
                conductivity: '‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏ü‡∏ü‡πâ‡∏≤',
                standard: '‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô',
                chemicalType: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ',
                amount: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô',
                note: '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏',
                optional: '‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö',
                maintenanceType: '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó',
                items: '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
                nextDate: '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ',
                selectType: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó',
                dailyCheck: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô',
                weeklyCheck: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå',
                monthlyCheck: '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
                repair: '‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢',
                emergencyRepair: '‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô',
                submit: 'üì§ ‡∏™‡πà‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
                submitting: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...',
                submitSuccess: '‚úÖ ‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                submitError: '‚ùå ‡∏™‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà',
                cancel: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                required: '‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô'
            }
        };

        // ‰∏ªÊáâÁî®Á®ãÂºè
        class App {
            constructor() {
                this.currentUser = null;
                this.language = 'zh';
                this.currentType = 'operation';
                this.formData = {};
                
                this.init();
            }

            init() {
                // Âæû URL ÂèÉÊï∏ÂèñÂæóÈ°ûÂûã
                const urlParams = new URLSearchParams(window.location.search);
                const typeParam = urlParams.get('type');
                if (typeParam) {
                    this.currentType = typeParam;
                }

                this.renderLogin();
            }

            t(key) {
                return TRANSLATIONS[this.language][key] || key;
            }

            renderLogin() {
                document.getElementById('root').innerHTML = `
                    <div class="login-screen">
                        <div class="login-card">
                            <div class="login-logo">üî•</div>
                            <h2 class="login-title">${this.t('loginTitle')}</h2>
                            <p class="login-subtitle">${this.t('loginSubtitle')}</p>
                            <form id="loginForm">
                                <input 
                                    type="text" 
                                    class="login-input" 
                                    id="employeeId"
                                    placeholder="${this.t('loginPlaceholder')}"
                                    required
                                    autocomplete="off"
                                />
                                <button type="submit" class="login-btn">
                                    ${this.t('loginButton')}
                                </button>
                                <div class="login-error" id="loginError">
                                    ${this.t('loginError')}
                                </div>
                            </form>
                        </div>
                    </div>
                `;

                document.getElementById('loginForm').addEventListener('submit', (e) => this.handleLogin(e));
            }

            handleLogin(e) {
                e.preventDefault();
                const id = document.getElementById('employeeId').value.toUpperCase();
                
                if (EMPLOYEE_DATABASE[id]) {
                    const user = EMPLOYEE_DATABASE[id];
                    this.currentUser = { id, ...user };
                    this.language = user.language;
                    this.renderMain();
                } else {
                    document.getElementById('loginError').classList.add('show');
                }
            }

            handleLogout() {
                this.currentUser = null;
                this.language = 'zh';
                this.renderLogin();
            }

            switchForm(type) {
                this.currentType = type;
                this.formData = {};
                this.renderMain();
            }

            calculateWaterFuelRatio() {
                const oilStart = parseFloat(this.formData.oilStart) || 0;
                const oilEnd = parseFloat(this.formData.oilEnd) || 0;
                const water = parseFloat(this.formData.water) || 0;
                
                const oilConsumption = oilStart - oilEnd;
                
                if (oilConsumption > 0 && water > 0) {
                    const ratio = (water / oilConsumption).toFixed(2);
                    const isOptimal = ratio >= 28 && ratio <= 32;
                    
                    return {
                        ratio: ratio,
                        isOptimal: isOptimal,
                        status: isOptimal ? 'optimal' : 'warning'
                    };
                }
                
                return null;
            }

            updateWaterFuelDisplay() {
                const display = document.getElementById('waterFuelDisplay');
                if (!display) return;

                const calc = this.calculateWaterFuelRatio();
                
                if (calc) {
                    display.innerHTML = `
                        <div class="calc-label">${this.t('waterFuelRatio')}</div>
                        <div class="calc-value">${calc.ratio}</div>
                        <div class="calc-unit">${this.t('literPerLiter')}</div>
                        <div class="calc-status ${calc.status}">
                            ${calc.isOptimal ? '‚úì ' + this.t('optimal') : '‚ö† ' + this.t('warning')}
                            (28-32)
                        </div>
                    `;
                    display.style.display = 'block';
                } else {
                    display.style.display = 'none';
                }
            }

            renderMain() {
                const typeButtons = [
                    { type: 'operation', label: this.t('operationRecord') },
                    { type: 'water', label: this.t('waterQuality') },
                    { type: 'chemical', label: this.t('chemicalRecord') },
                    { type: 'maintenance', label: this.t('maintenance') }
                ];

                document.getElementById('root').innerHTML = `
                    <div class="container">
                        <div class="header">
                            <div class="header-title">üî• ${this.t('loginTitle')}</div>
                            <div class="header-user">
                                <span>${this.t('welcome')}, ${this.currentUser.name}</span>
                                <button class="logout-btn-mobile" onclick="app.handleLogout()">
                                    ${this.t('logout')}
                                </button>
                            </div>
                        </div>

                        <div style="text-align: center; margin-bottom: 20px;">
                            <div class="status-badge">
                                <div class="status-dot"></div>
                                <span>${this.t('statusOnline')}</span>
                            </div>
                        </div>

                        <div class="type-selector">
                            ${typeButtons.map(btn => `
                                <button 
                                    class="type-btn ${this.currentType === btn.type ? 'active' : ''}"
                                    onclick="app.switchForm('${btn.type}')"
                                >
                                    ${btn.label}
                                </button>
                            `).join('')}
                        </div>

                        <div class="form-card">
                            <form id="dataForm">
                                ${this.renderFormContent()}
                                <div class="submit-section">
                                    <button type="submit" class="submit-btn" id="submitBtn">
                                        <span class="btn-text">${this.t('submit')}</span>
                                        <div class="loading-spinner"></div>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                `;

                document.getElementById('dataForm').addEventListener('submit', (e) => this.handleSubmit(e));
                
                // Â¶ÇÊûúÊòØÈÅãË°åË®òÈåÑ,Áõ£ËÅΩËº∏ÂÖ•ËÆäÂåñ‰ª•Ë®àÁÆóÊ∞¥ÁÖ§ÊØî
                if (this.currentType === 'operation') {
                    ['oilStart', 'oilEnd', 'water'].forEach(field => {
                        const input = document.getElementById(field);
                        if (input) {
                            input.addEventListener('input', () => {
                                this.formData[field] = input.value;
                                this.updateWaterFuelDisplay();
                            });
                        }
                    });
                }
            }

            renderFormContent() {
                switch(this.currentType) {
                    case 'operation':
                        return `
                            <div class="form-title">üìä ${this.t('operationRecord')}</div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">${this.t('oilStart')} <span class="required">*</span></label>
                                    <div class="input-unit">
                                        <input type="number" id="oilStart" class="form-input" placeholder="0" step="0.1" required>
                                        <span class="unit">${this.t('liter')}</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">${this.t('oilEnd')} <span class="required">*</span></label>
                                    <div class="input-unit">
                                        <input type="number" id="oilEnd" class="form-input" placeholder="0" step="0.1" required>
                                        <span class="unit">${this.t('liter')}</span>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">${this.t('water')} <span class="required">*</span></label>
                                    <div class="input-unit">
                                        <input type="number" id="water" class="form-input" placeholder="0" required>
                                        <span class="unit">${this.t('liter')}</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">${this.t('runtime')} <span class="required">*</span></label>
                                    <div class="input-unit">
                                        <input type="number" id="runtime" class="form-input" placeholder="0" step="0.1" required>
                                        <span class="unit">${this.t('hour')}</span>
                                    </div>
                                </div>
                            </div>

                            <div class="calculation-display" id="waterFuelDisplay" style="display: none;"></div>

                            <div class="form-group">
                                <label class="form-label">${this.t('note')}</label>
                                <input type="text" id="note" class="form-input" placeholder="${this.t('optional')}">
                                <div class="helper-text">${this.t('optional')}</div>
                            </div>
                        `;

                    case 'water':
                        return `
                            <div class="form-title">üíß ${this.t('waterQuality')}</div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">${this.t('phValue')} <span class="required">*</span></label>
                                    <input type="number" id="ph" class="form-input" placeholder="7.0" step="0.1" required>
                                    <div class="helper-text">${this.t('standard')}: 6.5-8.5</div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">${this.t('hardness')} <span class="required">*</span></label>
                                    <div class="input-unit">
                                        <input type="number" id="hardness" class="form-input" placeholder="0" required>
                                        <span class="unit">ppm</span>
                                    </div>
                                    <div class="helper-text">${this.t('standard')}: <100</div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">${this.t('chloride')} <span class="required">*</span></label>
                                    <div class="input-unit">
                                        <input type="number" id="chloride" class="form-input" placeholder="0" required>
                                        <span class="unit">ppm</span>
                                    </div>
                                    <div class="helper-text">${this.t('standard')}: <50</div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">${this.t('conductivity')} <span class="required">*</span></label>
                                    <div class="input-unit">
                                        <input type="number" id="conductivity" class="form-input" placeholder="0" required>
                                        <span class="unit">ŒºS/cm</span>
                                    </div>
                                    <div class="helper-text">${this.t('standard')}: <250</div>
                                </div>
                            </div>
                        `;

                    case 'chemical':
                        return `
                            <div class="form-title">üíä ${this.t('chemicalRecord')}</div>
                            
                            <div class="form-group">
                                <label class="form-label">${this.t('chemicalType')} <span class="required">*</span></label>
                                <select id="type" class="form-select" required>
                                    <option value="">${this.t('selectType')}</option>
                                    <option value="ÈòªÂû¢Âäë">ÈòªÂû¢Âäë</option>
                                    <option value="Èò≤ËÖêÂäë">Èò≤ËÖêÂäë</option>
                                    <option value="Èô§Ê∞ßÂäë">Èô§Ê∞ßÂäë</option>
                                    <option value="pHË™øÊï¥Âäë">pHË™øÊï¥Âäë</option>
                                    <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">${this.t('amount')} <span class="required">*</span></label>
                                <div class="input-unit">
                                    <input type="number" id="amount" class="form-input" placeholder="0" step="0.1" required>
                                    <span class="unit">${this.t('liter')}</span>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">${this.t('note')}</label>
                                <input type="text" id="note" class="form-input" placeholder="${this.t('optional')}">
                            </div>
                        `;

                    case 'maintenance':
                        return `
                            <div class="form-title">üîß ${this.t('maintenance')}</div>
                            
                            <div class="form-group">
                                <label class="form-label">${this.t('maintenanceType')} <span class="required">*</span></label>
                                <select id="type" class="form-select" required>
                                    <option value="">${this.t('selectType')}</option>
                                    <option value="Êó•Ê™¢">${this.t('dailyCheck')}</option>
                                    <option value="ÈÄ±Ê™¢">${this.t('weeklyCheck')}</option>
                                    <option value="ÊúàÊ™¢">${this.t('monthlyCheck')}</option>
                                    <option value="ÊïÖÈöúÁ∂≠‰øÆ">${this.t('repair')}</option>
                                    <option value="Á∑äÊÄ•Á∂≠‰øÆ">${this.t('emergencyRepair')}</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">${this.t('items')} <span class="required">*</span></label>
                                <input type="text" id="items" class="form-input" placeholder="" required>
                            </div>

                            <div class="form-group">
                                <label class="form-label">${this.t('nextDate')}</label>
                                <input type="date" id="nextDate" class="form-input">
                            </div>
                        `;
                }
            }

            async handleSubmit(e) {
                e.preventDefault();
                
                const submitBtn = document.getElementById('submitBtn');
                submitBtn.classList.add('loading');
                submitBtn.disabled = true;

                // Êî∂ÈõÜË°®ÂñÆÊï∏Êìö
                const form = document.getElementById('dataForm');
                const formData = new FormData(form);
                const data = {};
                
                // Ê†πÊìöË°®ÂñÆÈ°ûÂûãÊî∂ÈõÜ‰∏çÂêåÊ¨Ñ‰Ωç
                const fields = this.getFormFields();
                fields.forEach(field => {
                    const element = document.getElementById(field);
                    if (element) {
                        data[field] = element.value;
                    }
                });

                // Ë®àÁÆóÊ∞¥ÁÖ§ÊØî
                if (this.currentType === 'operation') {
                    const calc = this.calculateWaterFuelRatio();
                    if (calc) {
                        data.waterFuelRatio = calc.ratio;
                    }
                }

                try {
                    await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            type: this.currentType,
                            data: {
                                ...data,
                                operator: this.currentUser.name,
                                employeeId: this.currentUser.id
                            },
                            timestamp: new Date().toISOString()
                        })
                    });

                    this.showToast(this.t('submitSuccess'), 'success');
                    
                    setTimeout(() => {
                        form.reset();
                        this.formData = {};
                        const display = document.getElementById('waterFuelDisplay');
                        if (display) display.style.display = 'none';
                    }, 1500);

                } catch (error) {
                    console.error('Êèê‰∫§Â§±Êïó:', error);
                    this.showToast(this.t('submitError'), 'error');
                } finally {
                    submitBtn.classList.remove('loading');
                    submitBtn.disabled = false;
                }
            }

            getFormFields() {
                switch(this.currentType) {
                    case 'operation':
                        return ['oilStart', 'oilEnd', 'water', 'runtime', 'note'];
                    case 'water':
                        return ['ph', 'hardness', 'chloride', 'conductivity'];
                    case 'chemical':
                        return ['type', 'amount', 'note'];
                    case 'maintenance':
                        return ['type', 'items', 'nextDate'];
                    default:
                        return [];
                }
            }

            showToast(message, type = 'success') {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.className = `toast ${type} show`;

                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }
        }

        // ÂàùÂßãÂåñÊáâÁî®Á®ãÂºè
        const app = new App();
    </script>
</body>
</html>
